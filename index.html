<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Body House — Portail Marketing</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --bg-deep: #080808;
            --bg-primary: #0e0e0e;
            --bg-card: rgba(255,255,255,0.035);
            --bg-card-hover: rgba(255,255,255,0.055);
            --bg-card-inner: rgba(255,255,255,0.04);
            --coral: #F19D76;
            --coral-light: #f5b899;
            --coral-glow: rgba(241,157,118,0.15);
            --coral-soft: rgba(241,157,118,0.08);
            --beige: #f1dbcf;
            --beige-soft: rgba(241,219,207,0.08);
            --rose: #e8a0b4;
            --rose-soft: rgba(232,160,180,0.08);
            --text-primary: #f0ece8;
            --text-secondary: #8a8580;
            --text-tertiary: #5a5652;
            --border: rgba(255,255,255,0.06);
            --border-hover: rgba(241,157,118,0.25);
            --gradient-coral: linear-gradient(135deg, #F19D76 0%, #e87a4f 100%);
            --gradient-premium: linear-gradient(135deg, #F19D76 0%, #e8a0b4 50%, #f1dbcf 100%);
            --gradient-dark: linear-gradient(135deg, rgba(241,157,118,0.12) 0%, rgba(232,160,180,0.06) 100%);
            --shadow-glow: 0 0 40px rgba(241,157,118,0.08);
            --shadow-card: 0 4px 24px rgba(0,0,0,0.3);
            --radius: 16px;
            --radius-lg: 22px;
            --radius-xl: 28px;
            --meta-blue: #5b9cf6;
            --meta-soft: rgba(91,156,246,0.10);
            --google-yellow: #f6c95b;
            --google-soft: rgba(246,201,91,0.10);
            --gmb-green: #5bcf8a;
            --gmb-soft: rgba(91,207,138,0.10);
            --ease: cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-deep);
            color: var(--text-primary);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        /* ═══ AMBIENT BACKGROUND ═══ */
        .page-bg {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            background:
                radial-gradient(ellipse 80% 50% at 20% 0%, rgba(241,157,118,0.06) 0%, transparent 60%),
                radial-gradient(ellipse 60% 40% at 80% 100%, rgba(232,160,180,0.04) 0%, transparent 50%),
                radial-gradient(ellipse 50% 50% at 50% 50%, rgba(241,219,207,0.02) 0%, transparent 70%);
        }

        /* ═══ HEADER ═══ */
        .header {
            position: sticky;
            top: 0;
            z-index: 100;
            height: 72px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            background: rgba(8,8,8,0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
        }
        .header-left { display: flex; align-items: center; gap: 20px; }

        .logo-bh svg { height: 22px; width: auto; }
        .logo-bh svg path { fill: var(--text-primary); }

        .logo-divider {
            width: 1px;
            height: 28px;
            background: var(--border);
        }
        .logo-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .header-right { display: flex; align-items: center; gap: 16px; }

        .year-toggle {
            display: flex;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 3px;
            border: 1px solid var(--border);
        }
        .year-btn {
            padding: 8px 22px;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s var(--ease);
            background: transparent;
            color: var(--text-secondary);
        }
        .year-btn.active {
            background: var(--gradient-coral);
            color: #fff;
            box-shadow: 0 2px 16px rgba(241,157,118,0.35);
        }
        .year-btn:hover:not(.active) { color: var(--coral); }

        /* ═══ MAIN ═══ */
        .main {
            position: relative;
            z-index: 1;
            max-width: 1440px;
            margin: 0 auto;
            padding: 36px 40px 80px;
        }

        /* ═══ PERIOD SELECTOR ═══ */
        .period-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }
        .period-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-right: 8px;
            white-space: nowrap;
        }
        .period-pills {
            display: flex;
            gap: 4px;
            background: rgba(255,255,255,0.03);
            border-radius: 14px;
            padding: 4px;
            border: 1px solid var(--border);
        }
        .month-pill {
            padding: 8px 14px;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s var(--ease);
            background: transparent;
            color: var(--text-tertiary);
            white-space: nowrap;
        }
        .month-pill:hover { color: var(--coral-light); background: rgba(241,157,118,0.06); }
        .month-pill.active {
            background: var(--gradient-coral);
            color: #fff;
            box-shadow: 0 2px 12px rgba(241,157,118,0.3);
        }
        .month-pill.in-range {
            background: rgba(241,157,118,0.12);
            color: var(--coral-light);
        }
        .month-pill.disabled {
            opacity: 0.25;
            pointer-events: none;
        }
        .period-info {
            font-size: 13px;
            font-weight: 600;
            color: var(--coral);
            margin-left: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .period-reset {
            width: 20px; height: 20px;
            border-radius: 50%;
            background: rgba(241,157,118,0.1);
            border: none;
            color: var(--coral);
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-size: 12px;
            transition: all 0.2s;
        }
        .period-reset:hover { background: rgba(241,157,118,0.2); }

        /* ═══ HERO KPI ═══ */
        .kpi-hero {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 48px;
        }
        .kpi-card {
            position: relative;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 24px 26px;
            overflow: hidden;
            transition: all 0.35s var(--ease);
        }
        .kpi-card:hover {
            background: var(--bg-card-hover);
            border-color: var(--border-hover);
            transform: translateY(-3px);
            box-shadow: var(--shadow-glow);
        }
        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 2px;
            opacity: 0;
            transition: opacity 0.35s var(--ease);
        }
        .kpi-card:hover::before { opacity: 1; }
        .kpi-card:nth-child(1)::before { background: var(--meta-blue); }
        .kpi-card:nth-child(2)::before { background: var(--coral); }
        .kpi-card:nth-child(3)::before { background: var(--rose); }
        .kpi-card:nth-child(4)::before { background: var(--gmb-green); }

        .kpi-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1.2px;
            margin-bottom: 12px;
        }
        .kpi-value {
            font-size: 32px;
            font-weight: 900;
            letter-spacing: -1px;
            line-height: 1;
        }
        .kpi-card:nth-child(1) .kpi-value { color: var(--meta-blue); }
        .kpi-card:nth-child(2) .kpi-value { color: var(--coral); }
        .kpi-card:nth-child(3) .kpi-value { color: var(--rose); }
        .kpi-card:nth-child(4) .kpi-value { color: var(--gmb-green); }

        .kpi-detail {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-top: 8px;
            font-weight: 500;
        }

        /* ═══ SECTION HEADERS ═══ */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .section-title {
            font-size: 20px;
            font-weight: 800;
            letter-spacing: -0.3px;
        }
        .section-badge {
            font-size: 11px;
            font-weight: 700;
            background: var(--coral-soft);
            color: var(--coral);
            padding: 4px 14px;
            border-radius: 20px;
        }

        /* ═══ BOUTIQUES GRID ═══ */
        .boutiques-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 16px;
            margin-bottom: 56px;
            align-items: start;
        }

        .boutique-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
            transition: all 0.35s var(--ease);
            cursor: pointer;
        }
        .boutique-card:hover {
            background: var(--bg-card-hover);
            border-color: var(--border-hover);
            box-shadow: var(--shadow-glow);
        }
        .boutique-card.expanded {
            border-color: rgba(241,157,118,0.2);
            box-shadow: 0 0 50px rgba(241,157,118,0.06);
        }
        .boutique-card.inactive {
            opacity: 0.35;
        }

        .card-top {
            padding: 24px 26px 20px;
        }
        .card-name-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .card-name {
            font-size: 17px;
            font-weight: 800;
            letter-spacing: -0.2px;
        }
        .card-badge-inactive {
            font-size: 10px;
            font-weight: 600;
            background: rgba(255,255,255,0.06);
            color: var(--text-tertiary);
            padding: 3px 10px;
            border-radius: 8px;
        }

        .card-hero-row {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            gap: 16px;
        }
        .card-ca-block {}
        .card-ca-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 2px;
        }
        .card-ca-value {
            font-size: 24px;
            font-weight: 900;
            background: var(--gradient-premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .card-dep-block { text-align: right; }
        .card-dep-label {
            font-size: 9px;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 2px;
        }
        .card-dep-value {
            font-size: 18px;
            font-weight: 800;
            color: var(--coral);
            letter-spacing: -0.3px;
        }

        .card-sub-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 14px;
            padding-top: 14px;
            border-top: 1px solid var(--border);
        }

        .card-stats-mini {
            display: flex;
            gap: 20px;
        }
        .mini-stat {}
        .mini-stat-val {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
        }
        .mini-stat-label {
            font-size: 9px;
            font-weight: 500;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* GMB Stars */
        .gmb-rating {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .gmb-stars {
            display: flex;
            gap: 2px;
        }
        .gmb-stars svg {
            width: 13px;
            height: 13px;
        }
        .star-full { color: #f6c95b; }
        .star-half { color: #f6c95b; }
        .star-empty { color: rgba(255,255,255,0.1); }
        .gmb-note-val {
            font-size: 13px;
            font-weight: 700;
            color: var(--text-primary);
        }
        .gmb-note-label {
            font-size: 9px;
            font-weight: 500;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Expand indicator */
        .card-expand-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            border-top: 1px solid var(--border);
            color: var(--text-tertiary);
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            gap: 6px;
            transition: color 0.3s;
        }
        .boutique-card:hover .card-expand-bar { color: var(--coral); }
        .card-expand-bar svg {
            width: 14px; height: 14px;
            transition: transform 0.35s var(--ease-spring);
        }
        .boutique-card.expanded .card-expand-bar svg {
            transform: rotate(180deg);
        }

        /* Expandable details */
        .card-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.45s var(--ease);
        }
        .card-details-inner {
            padding: 0 26px 24px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* Detail sections */
        .detail-section {
            background: var(--bg-card-inner);
            border-radius: 14px;
            padding: 16px 18px;
            border: 1px solid rgba(255,255,255,0.03);
        }
        .detail-section-title {
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .detail-section-title .dot {
            width: 7px; height: 7px;
            border-radius: 50%;
        }
        .dot-meta { background: var(--meta-blue); }
        .dot-google { background: var(--google-yellow); }
        .dot-gmb { background: var(--gmb-green); }
        .ds-meta .detail-section-title { color: var(--meta-blue); }
        .ds-google .detail-section-title { color: var(--google-yellow); }
        .ds-gmb .detail-section-title { color: var(--gmb-green); }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px 16px;
        }
        .detail-grid.cols-3 { grid-template-columns: repeat(3, 1fr); }

        .detail-metric {}
        .dm-val {
            font-size: 15px;
            font-weight: 700;
        }
        .dm-label {
            font-size: 10px;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        /* Budget progress */
        .budget-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 10px;
        }
        .budget-bar-bg {
            flex: 1;
            height: 5px;
            background: rgba(255,255,255,0.06);
            border-radius: 5px;
            overflow: hidden;
        }
        .budget-bar-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.6s var(--ease);
        }
        .fill-ok { background: var(--gmb-green); }
        .fill-warn { background: var(--coral); }
        .fill-over { background: #ef5350; }
        .budget-text {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-tertiary);
            white-space: nowrap;
        }

        /* Site web footer */
        .detail-footer {
            display: flex;
            gap: 20px;
            padding-top: 8px;
        }
        .df-item {}
        .df-val { font-size: 14px; font-weight: 700; }
        .df-label { font-size: 9px; color: var(--text-tertiary); font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; }

        /* ═══ RAPPORTS DROPDOWN ═══ */
        .rapports-section { margin-top: 8px; }

        .rapports-dropdown {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
            margin-bottom: 16px;
            transition: all 0.35s var(--ease);
        }
        .rapports-dropdown:hover {
            border-color: var(--border-hover);
        }
        .rapports-dropdown-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 24px;
            cursor: pointer;
            user-select: none;
            transition: background 0.25s;
        }
        .rapports-dropdown-header:hover {
            background: var(--bg-card-hover);
        }
        .rdh-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .rdh-icon {
            width: 38px; height: 38px;
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
        }
        .rdh-icon svg { width: 17px; height: 17px; }
        .rdh-icon-synth { background: var(--coral-soft); color: var(--coral); }
        .rdh-icon-skeepers { background: var(--rose-soft); color: var(--rose); }
        .rdh-title {
            font-size: 14px;
            font-weight: 700;
        }
        .rdh-count {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-tertiary);
        }
        .rdh-chevron {
            width: 20px; height: 20px;
            color: var(--text-tertiary);
            transition: transform 0.35s var(--ease-spring);
        }
        .rapports-dropdown.open .rdh-chevron {
            transform: rotate(180deg);
        }
        .rapports-dropdown-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.45s var(--ease);
        }
        .rapports-dropdown-body-inner {
            padding: 0 24px 20px;
        }

        .rapports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 10px;
        }
        .rapport-link {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 16px;
            background: var(--bg-card-inner);
            border: 1px solid rgba(255,255,255,0.03);
            border-radius: 14px;
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.25s var(--ease);
        }
        .rapport-link:hover {
            background: var(--bg-card-hover);
            border-color: var(--border-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }
        .rapport-icon {
            width: 34px; height: 34px;
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
        }
        .rapport-icon svg { width: 15px; height: 15px; }
        .ri-synth { background: var(--coral-soft); color: var(--coral); }
        .ri-skeepers { background: var(--rose-soft); color: var(--rose); }
        .rapport-text {}
        .rapport-label { font-size: 13px; font-weight: 600; }
        .rapport-sub { font-size: 11px; color: var(--text-tertiary); font-weight: 500; }

        /* ═══ RESPONSIVE ═══ */
        @media (max-width: 1100px) {
            .kpi-hero { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 900px) {
            .header { padding: 0 20px; }
            .main { padding: 24px 20px 60px; }
            .boutiques-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 640px) {
            .header { height: 60px; padding: 0 16px; }
            .main { padding: 20px 16px 40px; }
            .kpi-hero { grid-template-columns: 1fr 1fr; gap: 10px; }
            .kpi-value { font-size: 24px; }
            .kpi-card { padding: 18px 20px; border-radius: 16px; }
            .logo-label { display: none; }
            .logo-divider { display: none; }
            .rapports-grid { grid-template-columns: 1fr; }
            .year-btn { padding: 6px 14px; font-size: 12px; }
            .period-pills { overflow-x: auto; -webkit-overflow-scrolling: touch; }
            .month-pill { padding: 6px 10px; font-size: 11px; }
            .period-bar { gap: 6px; }
        }

        /* ═══ SCROLLBAR ═══ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.15); }
    </style>
</head>
<body>

<div class="page-bg"></div>

<!-- HEADER -->
<header class="header">
    <div class="header-left">
        <div class="logo-bh">
            <svg viewBox="0 0 231 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0.449219H10.4278C12.4884 0.449219 14.037 0.536638 15.0486 0.711476C16.0601 0.886314 16.9718 1.23599 17.771 1.78548C18.5703 2.33497 19.2447 3.0593 19.7692 3.97096C20.3062 4.88261 20.5685 5.89418 20.5685 7.01814C20.5685 8.242 20.2438 9.36596 19.5819 10.3775C18.92 11.4016 18.0333 12.1634 16.8969 12.6754C18.4829 13.1375 19.7068 13.9242 20.5685 15.0482C21.4177 16.1597 21.8548 17.471 21.8548 18.9821C21.8548 20.1685 21.58 21.3174 21.0305 22.4414C20.481 23.5653 19.7192 24.452 18.7701 25.1264C17.821 25.8007 16.6346 26.2129 15.2359 26.3627C14.3617 26.4626 12.2387 26.5126 8.87928 26.5376H0V0.449219ZM5.27012 4.78271V10.8146H8.71693C10.765 10.8146 12.0389 10.7896 12.5384 10.7272C13.4376 10.6148 14.1494 10.3026 14.6614 9.79057C15.1734 9.27854 15.4357 8.59168 15.4357 7.75495C15.4357 6.91823 15.2109 6.29381 14.7738 5.78178C14.3242 5.28224 13.6623 4.97003 12.7882 4.87013C12.2636 4.80768 10.765 4.78271 8.29232 4.78271H5.27012ZM5.27012 15.1606V22.1416H10.1406C12.0389 22.1416 13.2377 22.0917 13.7498 21.9793C14.5365 21.8419 15.1734 21.4922 15.6605 20.9427C16.1475 20.3933 16.3973 19.6564 16.3973 18.7198C16.3973 17.933 16.21 17.2711 15.8228 16.7217C15.4357 16.1722 14.8987 15.7725 14.1744 15.5228C13.4625 15.273 11.9015 15.1481 9.5037 15.1481H5.24514L5.27012 15.1606Z" fill="currentColor"/>
                <path d="M25.2391 13.6499C25.2391 10.9898 25.6387 8.76688 26.438 6.95606C27.0249 5.63228 27.8367 4.43339 28.8607 3.37188C29.8848 2.32285 31.0087 1.53608 32.2326 1.02405C33.8561 0.349676 35.7294 0 37.8524 0C41.6988 0 44.771 1.1864 47.0814 3.57169C49.3917 5.95698 50.5406 9.26642 50.5406 13.525C50.5406 17.7835 49.3917 21.0305 47.1063 23.4158C44.8209 25.8011 41.7488 26.9875 37.9273 26.9875C34.1059 26.9875 30.9588 25.8011 28.6734 23.4408C26.388 21.068 25.2391 17.8085 25.2391 13.6623M30.6591 13.475C30.6591 16.4348 31.3459 18.6702 32.7072 20.1938C34.0684 21.7174 35.8043 22.4792 37.9024 22.4792C40.0004 22.4792 41.7238 21.7174 43.0726 20.2063C44.4213 18.6952 45.0957 16.4223 45.0957 13.4001C45.0957 10.3779 44.4463 8.17992 43.135 6.70629C41.8237 5.23265 40.0878 4.49584 37.9148 4.49584C35.7419 4.49584 33.9935 5.24514 32.6697 6.73127C31.3459 8.21739 30.6715 10.4653 30.6715 13.4625" fill="currentColor"/>
                <path d="M54.6369 0.449219H64.2655C66.4385 0.449219 68.0869 0.611568 69.2359 0.948756C70.772 1.39834 72.0832 2.1976 73.1697 3.34654C74.2562 4.49547 75.093 5.90667 75.6674 7.56763C76.2419 9.24108 76.5166 11.2892 76.5166 13.7369C76.5166 15.8849 76.2544 17.7332 75.7174 19.2943C75.068 21.1925 74.1313 22.7286 72.92 23.9025C72.0083 24.7892 70.772 25.4885 69.2234 25.9881C68.062 26.3502 66.5009 26.5376 64.5652 26.5376H54.6494V0.449219H54.6369ZM59.907 4.85764V22.1416H63.8409C65.3145 22.1416 66.376 22.0542 67.0254 21.8919C67.8746 21.6796 68.5865 21.3174 69.1485 20.8054C69.7104 20.2933 70.1725 19.4566 70.5222 18.2827C70.8844 17.1088 71.0592 15.5228 71.0592 13.4996C71.0592 11.4765 70.8844 9.94043 70.5222 8.85394C70.16 7.77993 69.673 6.93072 69.0236 6.33127C68.3867 5.73183 67.5749 5.31971 66.5883 5.10741C65.8515 4.94506 64.4153 4.85764 62.2673 4.85764H59.907Z" fill="currentColor"/>
                <path d="M87.8311 26.5376V15.5602L78.2774 0.449219H84.4467L90.591 10.7647L96.6105 0.449219H102.68L93.0762 15.5852V26.5376H87.8311Z" fill="currentColor"/>
                <path d="M105.315 26.5376V0.449219H110.573V10.7147H120.901V0.449219H126.171V26.5376H120.901V15.1231H110.573V26.5376H105.315Z" fill="currentColor"/>
                <path d="M130.542 13.6499C130.542 10.9898 130.941 8.76688 131.728 6.95606C132.328 5.63228 133.127 4.43339 134.163 3.37188C135.187 2.32285 136.311 1.53608 137.535 1.02405C139.171 0.349676 141.044 0 143.167 0C147.014 0 150.086 1.1864 152.396 3.57169C154.707 5.95698 155.856 9.26642 155.856 13.525C155.856 17.7835 154.707 21.0305 152.421 23.4158C150.136 25.8011 147.064 26.9875 143.242 26.9875C139.421 26.9875 136.274 25.8011 133.988 23.4408C131.703 21.068 130.554 17.8085 130.554 13.6623M135.974 13.475C135.974 16.4348 136.661 18.6702 138.022 20.1938C139.383 21.7174 141.119 22.4792 143.217 22.4792C145.315 22.4792 147.039 21.7174 148.388 20.2063C149.736 18.6952 150.411 16.4223 150.411 13.4001C150.411 10.3779 149.749 8.17992 148.438 6.70629C147.126 5.23265 145.39 4.49584 143.217 4.49584C141.044 4.49584 139.296 5.24514 137.972 6.73127C136.649 8.21739 135.974 10.4653 135.974 13.4625" fill="currentColor"/>
                <path d="M160 0H165.27V14.1369C165.27 16.3723 165.333 17.8335 165.47 18.4954C165.695 19.5569 166.232 20.4186 167.081 21.068C167.93 21.7174 169.092 22.0421 170.565 22.0421C172.039 22.0421 173.188 21.7424 173.95 21.1304C174.711 20.5185 175.161 19.7692 175.323 18.8825C175.473 17.9958 175.548 16.5097 175.548 14.4491V0H180.818V13.6998C180.818 16.8344 180.681 19.0449 180.394 20.3312C180.106 21.63 179.582 22.7165 178.82 23.6031C178.058 24.4898 177.034 25.2017 175.748 25.7262C174.462 26.2507 172.788 26.5129 170.728 26.5129C168.242 26.5129 166.344 26.2257 165.058 25.6512C163.772 25.0768 162.747 24.3275 162.011 23.4033C161.261 22.4792 160.774 21.5176 160.537 20.506C160.2 19.0074 160.025 16.8094 160.025 13.8871V0H160Z" fill="currentColor"/>
                <path d="M184.954 18.0458L190.074 17.5463C190.386 19.2697 191.011 20.531 191.947 21.3427C192.896 22.1545 194.158 22.5541 195.769 22.5541C197.467 22.5541 198.741 22.192 199.603 21.4801C200.464 20.7683 200.889 19.9191 200.889 18.9574C200.889 18.3455 200.702 17.821 200.352 17.3839C199.99 16.9468 199.353 16.5722 198.454 16.2599C197.842 16.0476 196.431 15.673 194.233 15.1235C191.41 14.4241 189.425 13.5624 188.288 12.5384C186.69 11.1022 185.89 9.35384 185.89 7.29325C185.89 5.96947 186.265 4.72063 187.014 3.5592C187.764 2.39778 188.85 1.52359 190.274 0.911656C191.698 0.312211 193.409 0 195.407 0C198.679 0 201.151 0.724329 202.8 2.14801C204.461 3.58418 205.322 5.5074 205.41 7.89269L200.14 8.12997C199.915 6.79371 199.428 5.81961 198.691 5.23266C197.954 4.6457 196.843 4.35846 195.357 4.35846C193.871 4.35846 192.634 4.67068 191.76 5.30759C191.198 5.70722 190.923 6.25671 190.923 6.93108C190.923 7.54302 191.186 8.08002 191.71 8.51711C192.372 9.07909 193.983 9.65356 196.556 10.2655C199.116 10.8649 201.014 11.5019 202.238 12.1388C203.462 12.7882 204.423 13.6748 205.123 14.7863C205.822 15.8978 206.159 17.2965 206.159 18.945C206.159 20.4436 205.747 21.8423 204.91 23.1411C204.086 24.4399 202.9 25.414 201.389 26.0509C199.865 26.6878 197.979 27 195.706 27C192.409 27 189.874 26.2382 188.101 24.7146C186.328 23.191 185.279 20.9681 184.929 18.0458" fill="currentColor"/>
                <path d="M210.605 26.5376V0.449219H229.95V4.85764H215.875V10.6398H228.976V15.0357H215.875V22.1416H230.449V26.5376H210.605Z" fill="currentColor"/>
            </svg>
        </div>
        <div class="logo-divider"></div>
        <div class="logo-label">Portail Marketing</div>
    </div>
    <div class="header-right">
        <div class="year-toggle">
            <button class="year-btn active" onclick="switchYear('2025')">2025</button>
            <button class="year-btn" onclick="switchYear('2026')">2026</button>
        </div>
    </div>
</header>

<!-- MAIN -->
<main class="main">

    <!-- PERIOD SELECTOR -->
    <div class="period-bar">
        <div class="period-label">Periode :</div>
        <div class="period-pills" id="periodPills">
            <button class="month-pill active" data-month="-1" onclick="selectMonth(-1)">Annuel</button>
            <button class="month-pill" data-month="0" onclick="selectMonth(0)">Jan</button>
            <button class="month-pill" data-month="1" onclick="selectMonth(1)">Fev</button>
            <button class="month-pill" data-month="2" onclick="selectMonth(2)">Mar</button>
            <button class="month-pill" data-month="3" onclick="selectMonth(3)">Avr</button>
            <button class="month-pill" data-month="4" onclick="selectMonth(4)">Mai</button>
            <button class="month-pill" data-month="5" onclick="selectMonth(5)">Jun</button>
            <button class="month-pill" data-month="6" onclick="selectMonth(6)">Jul</button>
            <button class="month-pill" data-month="7" onclick="selectMonth(7)">Aou</button>
            <button class="month-pill" data-month="8" onclick="selectMonth(8)">Sep</button>
            <button class="month-pill" data-month="9" onclick="selectMonth(9)">Oct</button>
            <button class="month-pill" data-month="10" onclick="selectMonth(10)">Nov</button>
            <button class="month-pill" data-month="11" onclick="selectMonth(11)">Dec</button>
        </div>
        <div class="period-info" id="periodInfo"></div>
    </div>

    <!-- KPI HERO -->
    <div class="kpi-hero" id="kpiHero"></div>

    <!-- BOUTIQUES -->
    <div class="section-header">
        <div class="section-title">Performances par boutique</div>
        <span class="section-badge" id="boutiqueCount">15 boutiques</span>
    </div>
    <div class="boutiques-grid" id="boutiquesGrid"></div>

    <!-- RAPPORTS -->
    <div class="rapports-section">
        <div class="section-header">
            <div class="section-title">Rapports & Analyses</div>
        </div>

        <div class="rapports-dropdown" onclick="toggleDropdown(this)">
            <div class="rapports-dropdown-header">
                <div class="rdh-left">
                    <div class="rdh-icon rdh-icon-synth"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg></div>
                    <div><div class="rdh-title">Syntheses boutiques — 2025</div><div class="rdh-count">13 rapports</div></div>
                </div>
                <svg class="rdh-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="rapports-dropdown-body">
                <div class="rapports-dropdown-body-inner">
                    <div class="rapports-grid" id="rapportsSynthGrid"></div>
                </div>
            </div>
        </div>

        <div class="rapports-dropdown" onclick="toggleDropdown(this)">
            <div class="rapports-dropdown-header">
                <div class="rdh-left">
                    <div class="rdh-icon rdh-icon-skeepers"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg></div>
                    <div><div class="rdh-title">Skeepers — 2025</div><div class="rdh-count">1 rapport</div></div>
                </div>
                <svg class="rdh-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="rapports-dropdown-body">
                <div class="rapports-dropdown-body-inner">
                    <div class="rapports-grid" id="rapportsSkeepersGrid"></div>
                </div>
            </div>
        </div>
    </div>

</main>

<script>
const DATA_MONTHLY = {
  "2025": {
    "Avignon Nord": {
      meta_imp: [945523, 1113058, 334051, 125128, 641672, 633100, 436119, 426365, 364665, 358859, 393914, 626619],
      meta_clics: [2631, 3354, 1331, 9852, 2984, 2765, 2544, 7262, 5695, 5380, 7765, 6302],
      meta_eng: [83, 146, 482, 263, 694, 526, 381, 1107, 973, 872, 1310, 1389],
      meta_dep: [800, 800, 444, 320, 806, 800, 423, 531, 700, 700, 1200, 1500],
      meta_budget_m: [800, 800, 400, 160, 800, 800, 400, 700, 700, 700, 1200, 1500],
      google_imp: [14005, 10793, 8356, 5867, 11674, 13141, 6841, 7131, 6211, 6692, 6719, 7358],
      google_clics: [3381, 3175, 1869, 1733, 2214, 2319, 1704, 1774, 1315, 1446, 1826, 2011],
      google_dep: [973, 628, 448, 257, 860, 798, 286, 288, 291, 291, 292, 293],
      google_budget_m: [800, 800, 400, 160, 800, 800, 300, 300, 300, 300, 300, 300],
      gmb_imp: [9212, 8633, 8495, 7403, 7348, 6503, 6511, 11468, 8834, 9100, 13309, 14273],
      appels: [95, 70, 47, 69, 83, 59, 72, 75, 76, 71, 62, 54],
      itineraires: [238, 277, 268, 271, 243, 244, 390, 479, 285, 333, 295, 309],
      gmb_note: [5, 5, 5, 5, 4.8, 5, 5, 5, 5, 5, 4.9, 5],
      visites: [6789, 5591, 3028, 1960, 3941, 4283, 4182, 4560, 2786, 3319, 3397, 3933],
      ca_ttc: [107235, 134493, 105942, 93382, 96391, 94151, 128650, 141704, 99771, 114305, 118955, 164802]
    },
    "Avignon Sud": {
      meta_imp: [1008386, 1154736, 566870, 125128, 565097, 594774, 462714, 631517, 482516, 360151, 378772, 644720],
      meta_clics: [2632, 2979, 2035, 9852, 704, 663, 2762, 10304, 5473, 5507, 6278, 5333],
      meta_eng: [71, 52, 704, 263, 68, 65, 349, 1539, 942, 847, 1174, 1213],
      meta_dep: [800, 800, 800, 320, 800, 800, 526, 869, 811, 700, 1200, 1500],
      meta_budget_m: [800, 800, 800, 160, 800, 800, 495, 700, 700, 700, 1200, 1500],
      google_imp: [15821, 11893, 13203, 6808, 12983, 14717, 7397, 7258, 7444, 8303, 7952, 8076],
      google_clics: [2959, 2698, 2754, 1941, 2198, 2282, 1548, 1611, 1314, 1356, 1730, 1922],
      google_dep: [973, 632, 638, 313, 870, 804, 291, 286, 296, 303, 304, 300],
      google_budget_m: [800, 800, 800, 160, 800, 800, 300, 300, 300, 300, 300, 300],
      gmb_imp: [7674, 7145, 6486, 6152, 6285, 5229, 5429, 9511, 7155, 7064, 8614, 8795],
      appels: [53, 40, 36, 55, 42, 73, 41, 41, 33, 42, 42, 28],
      itineraires: [185, 189, 208, 216, 180, 137, 248, 305, 255, 231, 206, 198],
      gmb_note: [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
      visites: [4122, 4197, 2931, 1202, 2411, 2636, 2451, 2767, 2153, 2096, 2850, 2928],
      ca_ttc: [46533, 53503, 34124, 38475, 40186, 37810, 46130, 60113, 44241, 42645, 38904, 53826]
    },
    "Aubiere": {
      meta_imp: [262371, 264124, 69503, 222001, 227361, 250353, 45278, 281269, 241202, 257933, 330896, 424252],
      meta_clics: [1500, 2016, 949, 1911, 2557, 1788, 803, 7273, 5268, 5285, 5476, 5617],
      meta_eng: [73, 159, 467, 801, 1061, 879, 196, 1510, 1155, 1515, 2247, 3453],
      meta_dep: [288, 292, 300, 1004, 1004, 997, 142, 957, 999, 997, 1700, 2000],
      meta_budget_m: [300, 300, 300, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1700, 2000],
      google_imp: [10632, 4713, 4866, 4766, 5567, 5616, 5644, 5744, 5314, 5891, 6650, 6595],
      google_clics: [2236, 1114, 917, 781, 831, 860, 787, 839, 764, 983, 1118, 1247],
      google_dep: [608, 296, 273, 305, 311, 307, 285, 287, 293, 295, 298, 296],
      google_budget_m: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300],
      gmb_imp: [4442, 4018, 3778, 3258, 2950, 2583, 2663, 4218, 3227, 3339, 3728, 3822],
      appels: [38, 36, 32, 54, 53, 47, 53, 33, 30, 44, 37, 41],
      itineraires: [220, 255, 186, 188, 146, 131, 221, 245, 168, 182, 168, 210],
      gmb_note: [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
      visites: [3621, 3394, 1903, 2005, 2671, 2145, 2150, 2991, 2646, 2778, 3403, 3248],
      ca_ttc: [51336, 59693, 38566, 36566, 41343, 31758, 41881, 53651, 44753, 51128, 45335, 61141]
    },
    "Biganos": {
      meta_imp: [350690, 279238, 62001, 75609, 120235, 123534, 145022, 168295, 138777, 149367, 113790, 135884],
      meta_clics: [1089, 1139, 276, 414, 1437, 1225, 1636, 5449, 3613, 4198, 3240, 2029],
      meta_eng: [200, 309, 478, 633, 1120, 1110, 874, 1721, 1028, 2000, 1818, 2170],
      meta_dep: [214, 310, 300, 300, 500, 500, 525, 675, 700, 700, 700, 700],
      meta_budget_m: [0, 500, 300, 300, 500, 500, 500, 700, 700, 700, 700, 700],
      google_imp: [10214, 4360, 2697, 2070, 5146, 5420, 5890, 5151, 4386, 4893, 5678, 5485],
      google_clics: [1971, 848, 614, 339, 810, 846, 913, 860, 702, 736, 867, 976],
      google_dep: [753, 711, 413, 447, 719, 720, 659, 484, 488, 492, 488, 494],
      google_budget_m: [0, 700, 300, 300, 700, 700, 700, 500, 500, 500, 500, 500],
      gmb_imp: [2278, 1983, 2248, 2118, 1949, 1781, 1869, 3024, 2097, 2263, 2934, 3432],
      appels: [17, 27, 17, 31, 25, 46, 24, 16, 15, 19, 26, 28],
      itineraires: [69, 89, 80, 109, 81, 128, 158, 166, 115, 77, 69, 138],
      gmb_note: [5, 5, 5, 5, 5, 4.9, 5, 5, 5, 5, 4.9, 5],
      visites: [2422, 1834, 1310, 1066, 1817, 1577, 1732, 1918, 1461, 1711, 1863, 1871],
      ca_ttc: [25342, 35393, 28600, 25465, 24594, 24120, 25617, 28890, 23359, 27126, 24700, 42617]
    },
    "Chambery": {
      meta_imp: [524855, 311815, 73890, 129408, 85159, 91388, 197848, 203011, 170582, 192923, 163406, 194512],
      meta_clics: [1227, 1992, 859, 1377, 1209, 1383, 2854, 7933, 6241, 5632, 5687, 3771],
      meta_eng: [58, 191, 436, 578, 873, 592, 696, 941, 919, 1077, 1400, 1683],
      meta_dep: [300, 300, 300, 500, 500, 500, 1033, 967, 868, 1099, 1000, 1000],
      meta_budget_m: [300, 300, 300, 500, 500, 500, 1000, 1000, 1000, 1000, 1000, 1000],
      google_imp: [6624, 4148, 4215, 5130, 5746, 5610, 7596, 7257, 6875, 7147, 7923, 5436],
      google_clics: [1419, 1113, 891, 901, 952, 938, 1082, 1207, 1098, 1182, 1398, 1120],
      google_dep: [304, 296, 304, 507, 512, 505, 577, 577, 591, 594, 599, 296],
      google_budget_m: [300, 300, 300, 500, 500, 500, 600, 600, 600, 500, 500, 500],
      gmb_imp: [5642, 5664, 4391, 3871, 3696, 3310, 3262, 5370, 4486, 4804, 5534, 6538],
      appels: [41, 35, 20, 27, 39, 31, 39, 36, 42, 43, 39, 40],
      itineraires: [261, 283, 169, 189, 161, 141, 230, 322, 155, 263, 258, 258],
      gmb_note: [5, 5, 4.8, 5, 4.9, 5, 5, 5, 5, 5, 5, 4.9],
      visites: [3014, 3282, 1925, 2041, 2349, 2271, 3142, 3788, 2844, 3246, 3186, 3077],
      ca_ttc: [71914, 85328, 57522, 54646, 57141, 50753, 70760, 86300, 66066, 69807, 71972, 105815]
    },
    "Grenoble": {
      meta_imp: [598855, 606300, 101183, 96740, 107562, 76438, 201550, 259322, 161273, 183944, 169781, 186444],
      meta_clics: [1764, 1822, 1939, 1531, 1665, 1134, 3761, 10272, 6362, 5687, 4613, 3565],
      meta_eng: [39, 74, 813, 625, 780, 556, 1207, 1329, 1078, 878, 936, 935],
      meta_dep: [400, 400, 300, 300, 300, 200, 468, 709, 620, 700, 700, 700],
      meta_budget_m: [400, 400, 300, 300, 300, 300, 495, 700, 700, 700, 700, 700],
      google_imp: [5856, 5990, 5670, 5777, 6210, 6329, 6087, 5863, 6551, 7088, 7198, 7250],
      google_clics: [1579, 1361, 1068, 1038, 1096, 1034, 1114, 1085, 1057, 1185, 1371, 1462],
      google_dep: [456, 392, 302, 360, 339, 300, 289, 286, 295, 299, 299, 297],
      google_budget_m: [400, 400, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300],
      gmb_imp: [6084, 5704, 4988, 4636, 4229, 3914, 4019, 5900, 5234, 5397, 9740, 11011],
      appels: [63, 46, 61, 53, 72, 55, 72, 63, 52, 65, 34, 57],
      itineraires: [353, 300, 237, 203, 225, 275, 266, 350, 359, 342, 252, 322],
      gmb_note: [5, 4.9, 5, 5, 5, 5, 4.9, 5, 5, 5, 5, 5],
      visites: [3306, 3597, 2175, 2074, 2231, 2290, 2567, 2957, 2339, 2755, 2557, 2928],
      ca_ttc: [77444, 90675, 61649, 56034, 62729, 54596, 73341, 82177, 69582, 76691, 70314, 96301]
    },
    "Jacou": {
      meta_imp: [320022, 221866, 56309, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [1330, 1021, 348, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [75, 98, 391, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [342, 287, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [10116, 5151, 5832, 648, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1282, 790, 763, 107, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [456, 305, 301, 39, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [3053, 2948, 2645, 2108, 1856, 1692, 1991, 2767, 2182, 2328, 2359, 2385],
      appels: [24, 26, 16, 17, 25, 46, 14, 20, 17, 17, 17, 20],
      itineraires: [131, 173, 130, 106, 82, 137, 117, 160, 134, 72, 80, 93],
      gmb_note: [5, 0, 0, 1, 2.3, 5, 4.7, 0, 5, 5, 5, 4.8],
      visites: [1931, 3733, 971, 602, 491, 530, 670, 751, 523, 616, 593, 755],
      ca_ttc: [19768, 24716, 14851, 14488, 16441, 14455, 18759, 20380, 18251, 17469, 17235, 22507]
    },
    "Lyon": {
      meta_imp: [564776, 491797, 92424, 79376, 82154, 90719, 206178, 341427, 199388, 223163, 222073, 232117],
      meta_clics: [1662, 1664, 2357, 2461, 2530, 2374, 5135, 13763, 10079, 9474, 7404, 3025],
      meta_eng: [49, 81, 977, 952, 1097, 1005, 1816, 2368, 2007, 2100, 1376, 679],
      meta_dep: [300, 300, 300, 300, 300, 300, 499, 719, 745, 700, 700, 499],
      meta_budget_m: [300, 300, 300, 300, 300, 300, 495, 700, 700, 700, 700, 700],
      google_imp: [11512, 8745, 6924, 5672, 6859, 6516, 7137, 7368, 6752, 7342, 8013, 8099],
      google_clics: [2024, 1980, 1270, 1050, 1116, 1156, 1310, 1246, 1048, 1154, 1392, 1481],
      google_dep: [456, 406, 323, 285, 304, 297, 286, 286, 296, 300, 300, 295],
      google_budget_m: [400, 400, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300],
      gmb_imp: [14038, 13142, 11240, 10527, 9625, 8296, 8328, 12969, 11060, 11717, 17747, 18846],
      appels: [76, 77, 62, 74, 79, 60, 78, 114, 66, 73, 91, 65],
      itineraires: [396, 490, 348, 292, 256, 326, 473, 482, 481, 475, 488, 511],
      gmb_note: [5, 4.9, 5, 5, 5, 5, 4.9, 4.9, 4.9, 5, 4.9, 5],
      visites: [4378, 6570, 4263, 3888, 3505, 3346, 4012, 4194, 3457, 3698, 3783, 3710],
      ca_ttc: [93166, 105833, 83854, 73008, 73190, 64850, 94588, 106147, 83369, 99780, 100086, 133594]
    },
    "Montelimar": {
      meta_imp: [572631, 536208, 113113, 100067, 105511, 127403, 244357, 212433, 130612, 200699, 218960, 251698],
      meta_clics: [1454, 1776, 1587, 988, 932, 1053, 4679, 8781, 5262, 5866, 5058, 4956],
      meta_eng: [50, 107, 582, 306, 337, 475, 766, 684, 486, 632, 713, 805],
      meta_dep: [412, 338, 300, 300, 300, 300, 500, 679, 547, 772, 700, 700],
      meta_budget_m: [300, 300, 300, 300, 300, 300, 495, 700, 700, 700, 700, 700],
      google_imp: [7178, 3301, 2821, 2610, 3032, 3515, 3939, 4051, 4011, 3815, 4122, 4373],
      google_clics: [1532, 926, 726, 547, 545, 606, 669, 730, 593, 659, 821, 1028],
      google_dep: [456, 311, 303, 300, 301, 303, 291, 288, 292, 300, 298, 299],
      google_budget_m: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300],
      gmb_imp: [4251, 4062, 3849, 3572, 3340, 3056, 3165, 4919, 3785, 3919, 7337, 8074],
      appels: [39, 39, 21, 24, 37, 35, 39, 45, 43, 32, 41, 34],
      itineraires: [179, 225, 206, 197, 210, 132, 231, 323, 210, 169, 162, 208],
      gmb_note: [5, 4.8, 5, 4.9, 5, 5, 4.9, 5, 5, 5, 5, 5],
      visites: [2753, 2321, 1412, 1319, 1459, 1410, 1894, 2676, 1616, 1671, 1768, 2140],
      ca_ttc: [52613, 62914, 41063, 43024, 36400, 38753, 51945, 64211, 47554, 51605, 45667, 74157]
    },
    "Nimes": {
      meta_imp: [0, 0, 0, 0, 195936, 922665, 1022189, 616918, 401446, 417031, 350119, 363005],
      meta_clics: [0, 0, 0, 0, 1308, 4183, 5435, 6684, 3955, 3460, 3254, 2224],
      meta_eng: [0, 0, 0, 0, 222, 611, 714, 1791, 1129, 1593, 2110, 2688],
      meta_dep: [0, 0, 0, 0, 233, 917, 1038, 983, 1051, 1000, 1000, 1000],
      meta_budget_m: [0, 0, 0, 0, 0, 1000, 1000, 1000, 1000, 1000, 1000, 1000],
      google_imp: [0, 0, 0, 0, 589, 4773, 5573, 5413, 4959, 5716, 5706, 5683],
      google_clics: [0, 0, 0, 0, 99, 732, 874, 892, 724, 774, 953, 1032],
      google_dep: [0, 0, 0, 0, 60, 307, 287, 282, 290, 288, 288, 286],
      google_budget_m: [0, 0, 0, 0, 0, 300, 300, 300, 300, 300, 300, 300],
      gmb_imp: [4276, 3735, 3481, 3302, 2833, 2539, 2940, 4880, 3580, 3730, 5943, 5979],
      appels: [26, 16, 14, 16, 22, 25, 25, 48, 58, 33, 33, 55],
      itineraires: [158, 171, 135, 131, 94, 139, 156, 308, 184, 197, 195, 214],
      gmb_note: [5, 5, 0, 0, 5, 5, 5, 5, 5, 5, 5, 5],
      visites: [694, 710, 549, 565, 999, 2343, 3213, 2252, 1435, 1776, 2044, 1980],
      ca_ttc: [23017, 23673, 17136, 14508, 15510, 18207, 28084, 35994, 29285, 31254, 28455, 37569]
    },
    "Sainte-Eulalie": {
      meta_imp: [1045509, 558958, 82720, 274485, 244069, 229704, 296367, 288980, 238914, 212764, 183790, 198524],
      meta_clics: [5063, 2679, 796, 2809, 1905, 1784, 4142, 4404, 3099, 3743, 4005, 2942],
      meta_eng: [1123, 847, 642, 1712, 1284, 1224, 1900, 1397, 1361, 2407, 2523, 2388],
      meta_dep: [1003, 454, 302, 1000, 1000, 1000, 1033, 967, 894, 1105, 1000, 1000],
      meta_budget_m: [300, 300, 300, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000],
      google_imp: [21689, 5703, 5679, 6320, 6522, 6663, 6708, 7246, 7009, 7747, 7773, 7457],
      google_clics: [3244, 1088, 1002, 980, 1004, 1027, 1023, 1060, 932, 1044, 1169, 1265],
      google_dep: [1302, 293, 258, 304, 303, 301, 308, 290, 296, 299, 297, 296],
      google_budget_m: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300],
      gmb_imp: [4953, 4374, 4055, 3803, 3555, 3181, 3249, 4758, 3802, 4208, 4768, 4535],
      appels: [25, 60, 42, 33, 29, 40, 33, 26, 37, 56, 57, 39],
      itineraires: [134, 229, 151, 133, 124, 165, 194, 242, 185, 240, 142, 151],
      gmb_note: [5, 5, 5, 4.9, 5, 5, 5, 5, 5, 5, 5, 5],
      visites: [5187, 2909, 1836, 2365, 2677, 2493, 3426, 3088, 2494, 3206, 3206, 2910],
      ca_ttc: [38927, 43644, 33588, 30776, 31468, 30027, 37653, 45649, 37842, 45894, 38028, 52052]
    },
    "Tignieu": {
      meta_imp: [269868, 351870, 246466, 87068, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [952, 2376, 1196, 523, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [202, 574, 177, 353, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [194, 398, 396, 400, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [0, 400, 400, 400, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [6084, 3683, 4983, 4700, 660, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [828, 1001, 1100, 952, 122, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [456, 153, 183, 201, 29, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [0, 200, 200, 200, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [4852, 4646, 4262, 3489, 3487, 2715, 1592, 2523, 336, 96, 102, 88],
      appels: [21, 16, 23, 12, 21, 27, 52, 55, 17, 17, 6, 13],
      itineraires: [127, 139, 94, 78, 126, 99, 77, 61, 25, 70, 45, 26],
      gmb_note: [0, 5, 4.9, 5, 5, 0, 4, 0, 0, 0, 0, 0],
      visites: [1255, 1906, 1589, 1217, 570, 553, 488, 478, 89, 3, 0, 2],
      ca_ttc: [17126, 26780, 14195, 15466, 13460, 10918, 350, 0, 0, 0, 0, 0]
    },
    "Valence": {
      meta_imp: [434945, 530523, 114639, 101255, 0, 260585, 198864, 92579, 79941, 65622, 63842, 70757],
      meta_clics: [2071, 3575, 1478, 1746, 0, 3955, 2767, 5409, 4510, 2837, 1547, 1343],
      meta_eng: [98, 151, 556, 533, 0, 1263, 878, 847, 691, 422, 231, 237],
      meta_dep: [719, 734, 300, 300, 0, 600, 402, 392, 449, 400, 400, 400],
      meta_budget_m: [800, 400, 300, 300, 300, 300, 400, 400, 500, 400, 400, 400],
      google_imp: [5435, 4051, 4617, 4382, 4722, 4643, 4960, 5329, 4893, 5157, 5771, 5769],
      google_clics: [2727, 1342, 1014, 817, 803, 855, 909, 1046, 789, 928, 1223, 1397],
      google_dep: [1217, 402, 335, 299, 302, 297, 291, 289, 294, 297, 296, 294],
      google_budget_m: [800, 400, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300],
      gmb_imp: [5573, 5746, 5287, 4862, 5144, 4661, 4179, 6371, 5019, 5524, 11966, 12840],
      appels: [72, 69, 64, 56, 55, 74, 49, 79, 37, 46, 65, 69],
      itineraires: [207, 206, 193, 151, 229, 219, 257, 290, 255, 223, 213, 257],
      gmb_note: [4.8, 5, 4.9, 4.9, 4.9, 5, 5, 5, 4.9, 5, 5, 4.9],
      visites: [4011, 4142, 2018, 2117, 2188, 2121, 2452, 2919, 1872, 2266, 2258, 2681],
      ca_ttc: [76188, 91127, 70826, 56897, 65931, 66099, 84102, 87033, 73335, 91818, 88410, 111244]
    },
    "Salaise": {
      meta_imp: [211752, 247435, 123683, 107207, 189314, 188982, 768615, 344512, 305051, 287232, 216110, 248784],
      meta_clics: [966, 1278, 898, 829, 1926, 1902, 5071, 5783, 4301, 3906, 3654, 2764],
      meta_eng: [502, 233, 813, 589, 448, 484, 1091, 971, 891, 1007, 817, 1420],
      meta_dep: [273, 398, 608, 399, 620, 533, 1581, 819, 800, 800, 800, 900],
      meta_budget_m: [0, 400, 400, 400, 600, 600, 800, 800, 800, 800, 900, 900],
      google_imp: [9388, 3144, 2820, 3272, 5454, 4558, 5247, 6473, 6083, 6818, 7454, 7023],
      google_clics: [2087, 769, 612, 600, 852, 821, 900, 1115, 899, 994, 1296, 1459],
      google_dep: [456, 285, 203, 202, 347, 300, 299, 386, 389, 396, 396, 391],
      google_budget_m: [0, 200, 200, 200, 200, 200, 400, 400, 400, 400, 500, 500],
      gmb_imp: [3938, 4615, 4629, 4419, 3920, 3336, 3220, 4665, 3641, 3971, 6828, 7029],
      appels: [21, 27, 21, 26, 45, 24, 21, 30, 35, 36, 45, 50],
      itineraires: [119, 129, 113, 108, 89, 97, 140, 202, 173, 167, 212, 259],
      gmb_note: [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 4.5, 5],
      visites: [2225, 1914, 1036, 1181, 1534, 1535, 2254, 2316, 1907, 1999, 2294, 2344],
      ca_ttc: [36444, 42843, 33661, 28455, 29569, 26436, 39580, 39106, 36298, 36216, 35440, 52813]
    },
    "Villefranche": {
      meta_imp: [391723, 370079, 169977, 237972, 395245, 454540, 535617, 428935, 337425, 349373, 209941, 256460],
      meta_clics: [2229, 2492, 1866, 2323, 2050, 1704, 2203, 6596, 5517, 4698, 4463, 3189],
      meta_eng: [104, 309, 858, 1203, 914, 738, 711, 1006, 1132, 1474, 1588, 1631],
      meta_dep: [776, 735, 800, 1000, 1003, 997, 1020, 883, 1000, 997, 900, 1000],
      meta_budget_m: [800, 800, 800, 1000, 1000, 1000, 1000, 1000, 1000, 900, 900, 1000],
      google_imp: [4489, 8639, 12431, 11552, 12683, 13035, 13106, 12377, 12629, 13892, 13798, 13022],
      google_clics: [1286, 1855, 2183, 1889, 1913, 1976, 2041, 2045, 1774, 1930, 2305, 2730],
      google_dep: [456, 614, 636, 606, 617, 604, 613, 573, 578, 580, 580, 578],
      google_budget_m: [400, 600, 600, 600, 600, 600, 600, 600, 600, 700, 700, 600],
      gmb_imp: [5202, 5028, 4400, 4339, 4148, 3490, 3520, 4962, 3906, 4084, 5936, 6721],
      appels: [35, 45, 30, 18, 49, 21, 25, 32, 30, 104, 42, 34],
      itineraires: [199, 252, 210, 136, 150, 154, 148, 265, 205, 194, 212, 244],
      gmb_note: [5, 5, 5, 5, 5, 4.9, 5, 5, 5, 5, 5, 5],
      visites: [2021, 3108, 2389, 2594, 2864, 2676, 2978, 2929, 2588, 3192, 3493, 3758],
      ca_ttc: [44202, 42843, 43257, 35605, 45264, 34631, 43491, 51196, 38806, 42534, 42295, 71855]
    }
  },
  "2026": {
    "Avignon Nord": {
      meta_imp: [407698, 358532, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [3700, 3348, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [704, 703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [698, 783, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [700, 1500, 700, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [7266, 4068, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1715, 998, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [293, 161, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [13566, 7370, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [54, 35, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [309, 190, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [2893, 2015, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [126565, 62300, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Avignon Sud": {
      meta_imp: [424498, 337236, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [3719, 2522, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [766, 494, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [687, 779, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [700, 1500, 700, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [7726, 4078, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1725, 935, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [303, 163, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [8432, 4670, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [50, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [172, 107, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [4.9, 4.7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [2248, 1352, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [44169, 24990, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Aubiere": {
      meta_imp: [284207, 268236, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [7587, 3082, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [1829, 1324, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [1000, 1151, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [1000, 2000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [6708, 3634, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1153, 807, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [298, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [3476, 1648, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [38, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [248, 126, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 4.8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [2932, 1958, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [49607, 25518, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Biganos": {
      meta_imp: [161071, 88144, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [3890, 1138, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [1419, 885, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [700, 415, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [700, 700, 200, 200, 200, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [5328, 2756, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [898, 505, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [494, 272, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [500, 500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [3153, 1530, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [24, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [106, 43, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [1691, 1007, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [30396, 12896, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Chambery": {
      meta_imp: [235592, 125788, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [7988, 2811, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [1478, 532, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [1000, 576, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [1000, 1000, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [5097, 3831, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [988, 949, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [274, 265, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [500, 500, 500, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [6703, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [30, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [297, 156, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 4.7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [2964, 2083, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [84722, 38478, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Grenoble": {
      meta_imp: [213445, 102769, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [2964, 1392, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [859, 279, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [700, 400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [700, 700, 700, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [7008, 3612, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1407, 840, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [297, 169, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [10987, 5020, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [61, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [311, 172, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [2691, 1609, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [77611, 39321, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Jacou": {
      meta_imp: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [2100, 1001, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [38, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [85, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [576, 1038, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [20336, 8920, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Lyon": {
      meta_imp: [340344, 162388, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [6664, 3138, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [2557, 933, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [900, 385, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [700, 700, 700, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [8622, 4151, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1568, 860, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [300, 161, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [18434, 8679, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [57, 38, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [458, 222, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [3794, 2337, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [108507, 47431, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Montelimar": {
      meta_imp: [297516, 145778, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [5218, 2154, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [848, 237, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [700, 407, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [700, 700, 700, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [4006, 2427, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [810, 547, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [301, 168, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [7947, 4257, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [46, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [158, 103, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 4.9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [1620, 1152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [50904, 27044, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Nimes": {
      meta_imp: [548022, 263686, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [4785, 1092, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [23925, 759, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [1000, 572, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [1000, 1000, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [5773, 3032, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1003, 624, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [289, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [6356, 3374, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [41, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [218, 144, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [1926, 1121, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [29858, 16954, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Sainte-Eulalie": {
      meta_imp: [241936, 131156, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [4949, 1802, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [2187, 598, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [1000, 577, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [1000, 1000, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [7217, 3250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1251, 726, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [297, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [4273, 2087, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [35, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [152, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [2990, 1647, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [43871, 18719, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Tignieu": {
      meta_imp: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [111, 45, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [16, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [53, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Valence": {
      meta_imp: [71825, 53936, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [1879, 1067, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [177, 75, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [400, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [400, 400, 400, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_imp: [5464, 2683, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1212, 690, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [297, 163, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 300, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_imp: [13251, 7173, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [49, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [174, 103, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [2121, 1415, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [81944, 44049, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Salaise": {
      meta_imp: [277040, 404263, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [2472, 1944, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [819, 716, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [691, 1009, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [700, 1800, 500, 400, 900, 400, 1200, 1300, 800, 700, 700, 1800],
      google_imp: [6379, 6353, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1189, 1202, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [325, 544, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 1000, 300, 200, 500, 200, 600, 600, 300, 300, 300, 1000],
      gmb_imp: [7174, 4435, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [53, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [197, 109, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [4.9, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [1976, 1804, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [34620, 17244, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },
    "Villefranche": {
      meta_imp: [209838, 210714, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_clics: [4212, 1397, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_eng: [1131, 585, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_dep: [500, 582, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      meta_budget_m: [500, 1000, 700, 700, 500, 700, 500, 1000, 500, 700, 700, 1000],
      google_imp: [7531, 5562, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_clics: [1608, 1270, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_dep: [312, 267, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      google_budget_m: [300, 500, 300, 300, 300, 300, 300, 500, 300, 300, 300, 500],
      gmb_imp: [6788, 3132, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      appels: [38, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      itineraires: [272, 132, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      gmb_note: [5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      visites: [2587, 1893, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ca_ttc: [42954, 17244, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    }
  }
};

const MONTH_NAMES = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'];

const RAPPORTS = [
    { label: 'Aubiere', file: 'synthese-bodyhouse-aubiere-2025.pdf' },
    { label: 'Avignon Nord', file: 'synthese-bodyhouse-avignon-nord-2025.pdf' },
    { label: 'Avignon Sud', file: 'synthese-bodyhouse-avignon-sud-2025.pdf' },
    { label: 'Biganos', file: 'synthese-bodyhouse-biganos-2025.pdf' },
    { label: 'Chambery', file: 'synthese-bodyhouse-chambery-2025.pdf' },
    { label: 'Grenoble', file: 'synthese-bodyhouse-grenoble-2025.pdf' },
    { label: 'Jacou', file: 'synthese-bodyhouse-jacou-2025.pdf' },
    { label: 'Lyon', file: 'synthese-bodyhouse-lyon-2025.pdf' },
    { label: 'Montelimar', file: 'synthese-bodyhouse-montelimar-2025.pdf' },
    { label: 'Sainte-Eulalie', file: 'synthese-bodyhouse-sainte-eulalie-2025.pdf' },
    { label: 'Salaise', file: 'synthese-bodyhouse-salaise-2025.pdf' },
    { label: 'Valence', file: 'synthese-bodyhouse-valence-2025.pdf' },
    { label: 'Villefranche', file: 'synthese-bodyhouse-villefranche-2025.pdf' }
];

let currentYear = '2025';
let monthStart = -1; // -1 = annual
let monthEnd = -1;

function sumArr(arr, from, to) {
    let s = 0;
    for (let i = from; i <= to; i++) s += (arr[i] || 0);
    return s;
}

function avgArr(arr, from, to) {
    let vals = [];
    for (let i = from; i <= to; i++) if (arr[i] > 0) vals.push(arr[i]);
    return vals.length > 0 ? vals.reduce((a,b) => a+b) / vals.length : 0;
}

function getBoutiqueData(name) {
    const m = DATA_MONTHLY[currentYear][name];
    if (!m) return null;
    const from = monthStart === -1 ? 0 : Math.min(monthStart, monthEnd);
    const to = monthStart === -1 ? 11 : Math.max(monthStart, monthEnd);
    return {
        meta_imp: sumArr(m.meta_imp, from, to),
        meta_clics: sumArr(m.meta_clics, from, to),
        meta_eng: sumArr(m.meta_eng, from, to),
        meta_dep: sumArr(m.meta_dep, from, to),
        meta_budget: sumArr(m.meta_budget_m, from, to),
        google_imp: sumArr(m.google_imp, from, to),
        google_clics: sumArr(m.google_clics, from, to),
        google_dep: sumArr(m.google_dep, from, to),
        gmb_imp: sumArr(m.gmb_imp, from, to),
        appels: sumArr(m.appels, from, to),
        itineraires: sumArr(m.itineraires, from, to),
        gmb_note: avgArr(m.gmb_note, from, to),
        visites: sumArr(m.visites, from, to),
        ca_ttc: sumArr(m.ca_ttc, from, to)
    };
}

function fmt(n) { return (n || 0).toLocaleString('fr-FR'); }
function fmtE(n) { return (n || 0).toLocaleString('fr-FR') + ' \u20ac'; }
function fmtShort(n) {
    if (n >= 1000000) return (n / 1000000).toFixed(1).replace('.', ',') + 'M';
    if (n >= 1000) return Math.round(n / 1000) + 'K';
    return String(n);
}

function getPeriodLabel() {
    if (monthStart === -1) return 'Cumul annuel ' + currentYear;
    const from = Math.min(monthStart, monthEnd);
    const to = Math.max(monthStart, monthEnd);
    if (from === to) return MONTH_NAMES[from] + ' ' + currentYear;
    return MONTH_NAMES[from] + ' — ' + MONTH_NAMES[to] + ' ' + currentYear;
}

function selectMonth(m) {
    if (m === -1) {
        monthStart = -1;
        monthEnd = -1;
    } else if (monthStart === -1) {
        monthStart = m;
        monthEnd = m;
    } else if (monthStart === m && monthEnd === m) {
        monthStart = -1;
        monthEnd = -1;
    } else if (monthStart >= 0 && monthEnd === monthStart) {
        monthEnd = m;
    } else {
        monthStart = m;
        monthEnd = m;
    }
    updatePeriodUI();
    renderKPIs();
    renderBoutiques();
}

function updatePeriodUI() {
    const pills = document.querySelectorAll('.month-pill');
    const from = monthStart === -1 ? -1 : Math.min(monthStart, monthEnd);
    const to = monthStart === -1 ? -1 : Math.max(monthStart, monthEnd);
    
    pills.forEach(pill => {
        const mi = parseInt(pill.dataset.month);
        pill.classList.remove('active', 'in-range');
        if (mi === -1 && monthStart === -1) {
            pill.classList.add('active');
        } else if (mi >= 0 && from >= 0) {
            if (mi === from || mi === to) pill.classList.add('active');
            else if (mi > from && mi < to) pill.classList.add('in-range');
        }
    });

    const info = document.getElementById('periodInfo');
    if (monthStart === -1) {
        info.innerHTML = '';
    } else {
        info.innerHTML = getPeriodLabel() + ' <button class="period-reset" onclick="selectMonth(-1)" title="Revenir au cumul annuel">\u2715</button>';
    }
}

function renderKPIs() {
    const year = DATA_MONTHLY[currentYear];
    let tImp = 0, tClics = 0, tDep = 0, tCA = 0;
    Object.keys(year).forEach(name => {
        const d = getBoutiqueData(name);
        tImp += d.meta_imp + d.google_imp;
        tClics += d.meta_clics + d.google_clics;
        tDep += d.meta_dep + d.google_dep;
        tCA += d.ca_ttc;
    });

    const label = monthStart === -1 ? '' : '<div class="kpi-detail" style="color:var(--coral);font-weight:600">' + getPeriodLabel() + '</div>';

    document.getElementById('kpiHero').innerHTML = `
        <div class="kpi-card">
            <div class="kpi-label">Impressions publicitaires</div>
            <div class="kpi-value">${fmtShort(tImp)}</div>
            <div class="kpi-detail">${fmt(tImp)} — META + Google Ads</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-label">Clics publicitaires</div>
            <div class="kpi-value">${fmtShort(tClics)}</div>
            <div class="kpi-detail">${fmt(tClics)} — META + Google Ads</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-label">Investissement publicitaire</div>
            <div class="kpi-value">${fmtE(tDep)}</div>
            <div class="kpi-detail">META + Google Ads</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-label">Chiffre d\'affaires</div>
            <div class="kpi-value">${fmtShort(tCA)}\u20ac</div>
            <div class="kpi-detail">${fmtE(tCA)} CA TTC</div>
        </div>`;
}

function renderStars(note) {
    if (!note) return '';
    const full = Math.floor(note);
    const half = note % 1 >= 0.3 ? 1 : 0;
    const empty = 5 - full - half;
    const starFull = '<svg viewBox="0 0 24 24" fill="currentColor" class="star-full"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>';
    const starHalf = '<svg viewBox="0 0 24 24" class="star-half"><defs><linearGradient id="hg"><stop offset="50%" stop-color="#f6c95b"/><stop offset="50%" stop-color="rgba(255,255,255,0.1)"/></linearGradient></defs><path fill="url(#hg)" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>';
    const starEmpty = '<svg viewBox="0 0 24 24" fill="currentColor" class="star-empty"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>';
    return '<div class="gmb-stars">' + starFull.repeat(full) + starHalf.repeat(half) + starEmpty.repeat(empty) + '</div>';
}

function renderBoutiques() {
    const year = DATA_MONTHLY[currentYear];
    const entries = Object.keys(year).map(name => [name, getBoutiqueData(name)]);
    const sorted = entries.sort((a, b) => b[1].ca_ttc - a[1].ca_ttc);
    let active = 0;

    document.getElementById('boutiquesGrid').innerHTML = sorted.map(([name, d]) => {
        const off = d.meta_imp === 0 && d.google_imp === 0 && d.ca_ttc === 0;
        if (!off) active++;
        const pct = d.meta_budget > 0 ? Math.min((d.meta_dep / d.meta_budget) * 100, 120) : 0;
        const fc = pct > 105 ? 'fill-over' : pct > 90 ? 'fill-warn' : 'fill-ok';
        const totalDep = d.meta_dep + d.google_dep;

        return `
        <div class="boutique-card ${off ? 'inactive' : ''}" onclick="toggleCard(this)">
            <div class="card-top">
                <div class="card-name-row">
                    <div class="card-name">${name}</div>
                    ${off ? '<span class="card-badge-inactive">Inactif</span>' : ''}
                    ${d.gmb_note > 0 ? `<div class="gmb-rating">${renderStars(d.gmb_note)}<span class="gmb-note-val">${d.gmb_note.toFixed(1).replace('.', ',')}</span></div>` : ''}
                </div>
                <div class="card-hero-row">
                    <div class="card-ca-block">
                        <div class="card-ca-label">Chiffre d\'affaires</div>
                        <div class="card-ca-value">${fmtE(d.ca_ttc)}</div>
                    </div>
                    <div class="card-dep-block">
                        <div class="card-dep-label">Depenses totales</div>
                        <div class="card-dep-value">${fmtE(totalDep)}</div>
                    </div>
                </div>
                <div class="card-sub-row">
                    <div class="card-stats-mini">
                        <div class="mini-stat">
                            <div class="mini-stat-val">${fmtShort(d.meta_imp)}</div>
                            <div class="mini-stat-label">Impressions</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-val">${fmt(d.meta_clics)}</div>
                            <div class="mini-stat-label">Clics</div>
                        </div>
                    </div>
                    ${d.meta_budget > 0 ? `<div class="budget-text">${Math.round(pct)}% budget META</div>` : ''}
                </div>
            </div>

            <div class="card-expand-bar">
                <span>Details</span>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>

            <div class="card-details">
                <div class="card-details-inner">
                    <div class="detail-section ds-meta">
                        <div class="detail-section-title"><span class="dot dot-meta"></span> META</div>
                        <div class="detail-grid">
                            <div class="detail-metric"><div class="dm-val">${fmt(d.meta_imp)}</div><div class="dm-label">Impressions</div></div>
                            <div class="detail-metric"><div class="dm-val">${fmt(d.meta_clics)}</div><div class="dm-label">Clics</div></div>
                            <div class="detail-metric"><div class="dm-val">${fmtE(d.meta_dep)}</div><div class="dm-label">Depenses</div></div>
                            <div class="detail-metric"><div class="dm-val">${fmt(d.meta_eng)}</div><div class="dm-label">Engagements</div></div>
                        </div>
                        ${d.meta_budget > 0 ? `<div class="budget-row">
                            <div class="budget-bar-bg"><div class="budget-bar-fill ${fc}" style="width:${Math.min(pct, 100)}%"></div></div>
                            <div class="budget-text">${Math.round(pct)}% du budget (${fmtE(d.meta_budget)})</div>
                        </div>` : ''}
                    </div>
                    <div class="detail-section ds-google">
                        <div class="detail-section-title"><span class="dot dot-google"></span> GOOGLE ADS</div>
                        <div class="detail-grid cols-3">
                            <div class="detail-metric"><div class="dm-val">${fmt(d.google_imp)}</div><div class="dm-label">Impressions</div></div>
                            <div class="detail-metric"><div class="dm-val">${fmt(d.google_clics)}</div><div class="dm-label">Clics</div></div>
                            <div class="detail-metric"><div class="dm-val">${fmtE(d.google_dep)}</div><div class="dm-label">Depenses</div></div>
                        </div>
                    </div>
                    <div class="detail-section ds-gmb">
                        <div class="detail-section-title"><span class="dot dot-gmb"></span> GOOGLE MY BUSINESS</div>
                        <div class="detail-grid cols-3">
                            <div class="detail-metric"><div class="dm-val">${fmt(d.gmb_imp)}</div><div class="dm-label">Impressions</div></div>
                            <div class="detail-metric"><div class="dm-val">${fmt(d.appels)}</div><div class="dm-label">Appels</div></div>
                            <div class="detail-metric"><div class="dm-val">${fmt(d.itineraires)}</div><div class="dm-label">Itineraires</div></div>
                        </div>
                    </div>
                    <div class="detail-footer">
                        <div class="df-item"><div class="df-val">${fmt(d.visites)}</div><div class="df-label">Visites site web</div></div>
                    </div>
                </div>
            </div>
        </div>`;
    }).join('');

    document.getElementById('boutiqueCount').textContent = active + ' boutiques';
}

function toggleCard(card) {
    if (card.classList.contains('inactive')) return;
    const details = card.querySelector('.card-details');
    const isOpen = card.classList.contains('expanded');
    if (isOpen) {
        details.style.maxHeight = '0';
        card.classList.remove('expanded');
    } else {
        details.style.maxHeight = details.scrollHeight + 'px';
        card.classList.add('expanded');
    }
}

function toggleDropdown(el) {
    const body = el.querySelector('.rapports-dropdown-body');
    const isOpen = el.classList.contains('open');
    if (isOpen) {
        body.style.maxHeight = '0';
        el.classList.remove('open');
    } else {
        body.style.maxHeight = body.scrollHeight + 'px';
        el.classList.add('open');
    }
}

function renderRapports() {
    document.getElementById('rapportsSynthGrid').innerHTML = RAPPORTS.map(r => `
        <a class="rapport-link" href="${r.file}" target="_blank" onclick="event.stopPropagation()">
            <div class="rapport-icon ri-synth"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div>
            <div class="rapport-text"><div class="rapport-label">${r.label}</div><div class="rapport-sub">Synthese 2025</div></div>
        </a>`).join('');

    document.getElementById('rapportsSkeepersGrid').innerHTML = `
        <a class="rapport-link" href="rapport-skeepers-bodyhouse-2025.pdf" target="_blank" onclick="event.stopPropagation()">
            <div class="rapport-icon ri-skeepers"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg></div>
            <div class="rapport-text"><div class="rapport-label">Rapport Performance Skeepers</div><div class="rapport-sub">Octobre — Decembre 2025</div></div>
        </a>`;
}

function switchYear(y) {
    currentYear = y;
    monthStart = -1;
    monthEnd = -1;
    document.querySelectorAll('.year-btn').forEach(b => b.classList.toggle('active', b.textContent === y));
    updatePeriodUI();
    renderKPIs();
    renderBoutiques();
}

renderKPIs();
renderBoutiques();
renderRapports();
</script>
</body>
</html>
